<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>RepMax</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">Scrapbook-0.3.4: code examples</span><ul class="links" id="page-menu"><li><a href="src/RepMax.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>&#169; Frank Jung 2020</td></tr><tr><th>License</th><td>GPL-3</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">RepMax</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>From
<a href="https://danilafe.com/blog/haskell_lazy_evaluation/">Time Traveling In Haskell: How It Works And How To Use It</a> by Daniel Lafe.</p><p>Code for what Csongor calls the repMax problem:</p><pre>Imagine you had a list, and you wanted to replace all the elements of
the list with the largest element, by only passing the list once.</pre><p>How can we possibly do this in one pass? First, we need to find the maximum
element, and only then can we have something to replace the other numbers
with! It turns out, though, that we can just expect to have the future
value, and all will be well.</p><p>In the function <code><a href="RepMax.html#v:repMax" title="RepMax">repMax</a></code> takes the list of integers, each of which it must
replace with their maximum element. It also takes as an argument the
maximum element, as if it had already been computed. It does, however,
still compute the intermediate maximum element, in the form of <code>m'</code>.
Otherwise, where would the future value even come from?</p><p>Thus far, nothing too magical has happened. It&#8217;s a little strange to expect
the result of the computation to be given to us; it just looks like wishful
thinking. The real magic happens in Csongor&#8217;s <code><a href="RepMax.html#v:doRepMax" title="RepMax">doRepMax</a></code> function.</p><p>Look, in particular, on the line with the <code>where</code> clause. We see that
<code><a href="RepMax.html#v:repMax" title="RepMax">repMax</a></code> returns the maximum element of the list, largest, and the
resulting list <code>xs'</code> consisting only of <em>largest</em> repeated as many times as
<code>xs</code> had elements. But what&#8217;s curious is the call to <code><a href="RepMax.html#v:repMax" title="RepMax">repMax</a></code> itself. It
takes as input <code>xs</code>, the list we&#8217;re supposed to process and largest, the
value that <em>it itself returns</em>.</p><p>See also <a href="https://kcsongor.github.io/time-travel-in-haskell-for-dummies/">Time travel in Haskell for dummies</a>
by Csongor Kiss.</p><p>See
<a href="https://stackoverflow.com/questions/44558242/picture-how-mapaccumr-works">this</a>
for an explanation on how <code><a href="../base-4.17.2.1/Data-Traversable.html#v:mapAccumR" title="Data.Traversable">mapAccumR</a></code> works.</p><h2>Example</h2><p>Run <code><a href="RepMax.html#v:doRepMax" title="RepMax">doRepMax</a></code> or <code><a href="RepMax.html#v:foldMax" title="RepMax">foldMax</a></code> over some lists:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>doRepMax [2,3,1,4,5]
</code></strong>[5,5,5,5,5]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>doRepMax [-2,-3,-1,-4,-5]
</code></strong>[-1,-1,-1,-1,-1]
</pre></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:doRepMax">doRepMax</a> :: <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a =&gt; [a] -&gt; [a]</li><li class="src short"><a href="#v:foldMax">foldMax</a> :: <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a =&gt; [a] -&gt; [a]</li><li class="src short"><a href="#v:repMax">repMax</a> :: <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a =&gt; [a] -&gt; a -&gt; (a, [a])</li><li class="src short"><a href="#v:traverseMax">traverseMax</a> :: (<a href="../base-4.17.2.1/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a) =&gt; t a -&gt; t a</li><li class="src short"><a href="#v:traverseMax-39-">traverseMax'</a> :: (<a href="../base-4.17.2.1/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a) =&gt; t a -&gt; t a</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:doRepMax" class="def">doRepMax</a> <a href="src/RepMax.html#doRepMax" class="link">Source</a> <a href="#v:doRepMax" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; [a]</td><td class="doc"><p>input list</p></td></tr><tr><td class="src">-&gt; [a]</td><td class="doc"><p>list with elements replaced with maximum value</p></td></tr></table></div><div class="doc"><p>Replace list with maximum value in the list.</p></div></div><div class="top"><p class="src"><a id="v:foldMax" class="def">foldMax</a> <a href="src/RepMax.html#foldMax" class="link">Source</a> <a href="#v:foldMax" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; [a]</td><td class="doc"><p>list to change</p></td></tr><tr><td class="src">-&gt; [a]</td><td class="doc"><p>list replaced with maximum element</p></td></tr></table></div><div class="doc"><p>Fold version of <code><a href="RepMax.html#v:repMax" title="RepMax">repMax</a></code>.</p><p>Modified to also work with negative values.
 <em>&quot;Everything's a fold&quot;.</em></p></div></div><div class="top"><p class="src"><a id="v:repMax" class="def">repMax</a> <a href="src/RepMax.html#repMax" class="link">Source</a> <a href="#v:repMax" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; [a]</td><td class="doc"><p>list to replace</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>maximum value used in replacement</p></td></tr><tr><td class="src">-&gt; (a, [a])</td><td class="doc"><p>maximum and modified list maximum element</p></td></tr></table></div><div class="doc"><p>Repeat given maximum for entire list.</p></div></div><div class="top"><p class="src"><a id="v:traverseMax" class="def">traverseMax</a> <a href="src/RepMax.html#traverseMax" class="link">Source</a> <a href="#v:traverseMax" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.17.2.1/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; t a</td><td class="doc"><p>traversable input</p></td></tr><tr><td class="src">-&gt; t a</td><td class="doc"><p>modified with maximum element</p></td></tr></table></div><div class="doc"><p>Generalise <code><a href="RepMax.html#v:repMax" title="RepMax">repMax</a></code> where input is a <code>Traversable</code>.</p><p>Seed value from <code>First</code> of <code>Foldable</code>.</p></div></div><div class="top"><p class="src"><a id="v:traverseMax-39-" class="def">traverseMax'</a> <a href="src/RepMax.html#traverseMax%27" class="link">Source</a> <a href="#v:traverseMax-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.17.2.1/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.17.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; t a</td><td class="doc"><p>traversable input</p></td></tr><tr><td class="src">-&gt; t a</td><td class="doc"><p>modified with maximum element</p></td></tr></table></div><div class="doc"><p>Generalise <code><a href="RepMax.html#v:repMax" title="RepMax">repMax</a></code> where input is a <code>Traversable</code>.</p><p>Seed maximum value from head of list or 0 if empty.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.27.0</p></div></body></html>