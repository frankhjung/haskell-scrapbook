<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric      #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="annot"><span class="hs-comment">{-|

Module      : MyJson
Description : Decode JSON
Copyright   : &#169; Frank Jung, 2023
License     : GPL-3

Decode JSON which contains special characters like '&#176;' (ASCII decimal \176).

See also [app/Json.hs](app/Json.hs) for an example of how to parse JSON when the
first key is variable. This is common in APIs such as the Alpha Vantage weekly
stock prices. In that case, the first key is the date of that weeks summary data.

== References

I found this a good guide when dealing with JSON and special characters:
&lt;https://guide.aelve.com/haskell/aeson-cookbook-amra6lk6&gt;

-}</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MyJson</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="MyJson.html#MyJson"><span class="hs-identifier">MyJson</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span>
</span><span id="line-28"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span>
</span><span id="line-29"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MyJson.html#eitherDecodeSpecial"><span class="hs-identifier">eitherDecodeSpecial</span></a></span><span>
</span><span id="line-30"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MyJson.html#encodeSpecial"><span class="hs-identifier">encodeSpecial</span></a></span><span>
</span><span id="line-31"></span><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                                </span><span class="annot"><span class="hs-identifier">eitherDecode</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">object</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseJSON</span></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>                                                </span><span class="annot"><span class="hs-identifier">toJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.:)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson.Text</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeToLazyText</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Encoding</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeLatin1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">encodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time.Clock</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><span class="hs-comment">-- | Define a test data type.</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">data</span><span> </span><span id="MyJson"><span class="annot"><a href="MyJson.html#MyJson"><span class="hs-identifier hs-var">MyJson</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MyJson"><span class="annot"><a href="MyJson.html#MyJson"><span class="hs-identifier hs-var">MyJson</span></a></span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="name"><span class="annot"><span class="annottext">MyJson -&gt; Text
</span><a href="MyJson.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="identifier"><span class="annot"><span class="annottext">MyJson -&gt; Int
</span><a href="MyJson.html#identifier"><span class="hs-identifier hs-var hs-var">identifier</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="modifier"><span class="annot"><span class="annottext">MyJson -&gt; Float
</span><a href="MyJson.html#modifier"><span class="hs-identifier hs-var hs-var">modifier</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="created"><span class="annot"><span class="annottext">MyJson -&gt; UTCTime
</span><a href="MyJson.html#created"><span class="hs-identifier hs-var hs-var">created</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="series"><span class="annot"><span class="annottext">MyJson -&gt; [Int]
</span><a href="MyJson.html#series"><span class="hs-identifier hs-var hs-var">series</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095720"><span id="local-6989586621679095732"><span class="annot"><span class="annottext">MyJson -&gt; MyJson -&gt; Bool
(MyJson -&gt; MyJson -&gt; Bool)
-&gt; (MyJson -&gt; MyJson -&gt; Bool) -&gt; Eq MyJson
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: MyJson -&gt; MyJson -&gt; Bool
== :: MyJson -&gt; MyJson -&gt; Bool
$c/= :: MyJson -&gt; MyJson -&gt; Bool
/= :: MyJson -&gt; MyJson -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095737"><span id="local-6989586621679095751"><span id="local-6989586621679095755"><span class="annot"><span class="annottext">Int -&gt; MyJson -&gt; ShowS
[MyJson] -&gt; ShowS
MyJson -&gt; String
(Int -&gt; MyJson -&gt; ShowS)
-&gt; (MyJson -&gt; String) -&gt; ([MyJson] -&gt; ShowS) -&gt; Show MyJson
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; MyJson -&gt; ShowS
showsPrec :: Int -&gt; MyJson -&gt; ShowS
$cshow :: MyJson -&gt; String
show :: MyJson -&gt; String
$cshowList :: [MyJson] -&gt; ShowS
showList :: [MyJson] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095759"><span id="local-6989586621679095761"><span class="annot"><span class="annottext">(forall x. MyJson -&gt; Rep MyJson x)
-&gt; (forall x. Rep MyJson x -&gt; MyJson) -&gt; Generic MyJson
forall x. Rep MyJson x -&gt; MyJson
forall x. MyJson -&gt; Rep MyJson x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. MyJson -&gt; Rep MyJson x
from :: forall x. MyJson -&gt; Rep MyJson x
$cto :: forall x. Rep MyJson x -&gt; MyJson
to :: forall x. Rep MyJson x -&gt; MyJson
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095766"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="MyJson.html#MyJson"><span class="hs-identifier hs-type">MyJson</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>  </span><span id="local-6989586621679095795"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser MyJson
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span id="local-6989586621679095797"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095797"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Float -&gt; UTCTime -&gt; [Int] -&gt; MyJson
</span><a href="MyJson.html#MyJson"><span class="hs-identifier hs-var">MyJson</span></a></span><span>
</span><span id="line-54"></span><span>                            </span><span class="annot"><span class="annottext">(Text -&gt; Int -&gt; Float -&gt; UTCTime -&gt; [Int] -&gt; MyJson)
-&gt; Parser Text
-&gt; Parser (Int -&gt; Float -&gt; UTCTime -&gt; [Int] -&gt; MyJson)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095797"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Text
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;name&quot;</span></span><span>
</span><span id="line-55"></span><span>                            </span><span class="annot"><span class="annottext">Parser (Int -&gt; Float -&gt; UTCTime -&gt; [Int] -&gt; MyJson)
-&gt; Parser Int -&gt; Parser (Float -&gt; UTCTime -&gt; [Int] -&gt; MyJson)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095797"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Int
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;identifier&quot;</span></span><span>
</span><span id="line-56"></span><span>                            </span><span class="annot"><span class="annottext">Parser (Float -&gt; UTCTime -&gt; [Int] -&gt; MyJson)
-&gt; Parser Float -&gt; Parser (UTCTime -&gt; [Int] -&gt; MyJson)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095797"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Float
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;modifier&quot;</span></span><span>
</span><span id="line-57"></span><span>                            </span><span class="annot"><span class="annottext">Parser (UTCTime -&gt; [Int] -&gt; MyJson)
-&gt; Parser UTCTime -&gt; Parser ([Int] -&gt; MyJson)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095797"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser UTCTime
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;created&quot;</span></span><span>
</span><span id="line-58"></span><span>                            </span><span class="annot"><span class="annottext">Parser ([Int] -&gt; MyJson) -&gt; Parser [Int] -&gt; Parser MyJson
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095797"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser [Int]
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;series&quot;</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser MyJson
forall a. String -&gt; Parser a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected an object&quot;</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095801"><span id="local-6989586621679095805"><span id="local-6989586621679095808"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="MyJson.html#MyJson"><span class="hs-identifier hs-type">MyJson</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679095834"><span class="annot"><span class="annottext">toJSON :: MyJson -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MyJson.html#MyJson"><span class="hs-identifier hs-type">MyJson</span></a></span><span> </span><span id="local-6989586621679095835"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679095835"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679095836"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095836"><span class="hs-identifier hs-var">_identifier</span></a></span></span><span> </span><span id="local-6989586621679095837"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679095837"><span class="hs-identifier hs-var">_modifier</span></a></span></span><span> </span><span id="local-6989586621679095838"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679095838"><span class="hs-identifier hs-var">_created</span></a></span></span><span> </span><span id="local-6989586621679095839"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679095839"><span class="hs-identifier hs-var">_series</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;name&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679095835"><span class="hs-identifier hs-var">_name</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;identifier&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Int -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095836"><span class="hs-identifier hs-var">_identifier</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;modifier&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Key -&gt; Float -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679095837"><span class="hs-identifier hs-var">_modifier</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;created&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Key -&gt; UTCTime -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679095838"><span class="hs-identifier hs-var">_created</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;series&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Key -&gt; [Int] -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679095839"><span class="hs-identifier hs-var">_series</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Decode Special Characters.</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Where:</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Data.Text.Lazy.Encoding.decodeLatin1 :: ByteString -&gt; Text</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Data.Text.Lazy.Encoding.encodeUtf8 :: Text -&gt; ByteString</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- Data.Aeson.eitherDecode :: ByteString -&gt; Either String a</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- This will successfully decode a ByteString containing special characters such</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- as '&#176;' (ASCII decimal \176).</span><span>
</span><span id="line-82"></span><span id="local-6989586621679095692"><span class="annot"><a href="MyJson.html#eitherDecodeSpecial"><span class="hs-identifier hs-type">eitherDecodeSpecial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679095692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679095692"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-83"></span><span id="eitherDecodeSpecial"><span class="annot"><span class="annottext">eitherDecodeSpecial :: forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="MyJson.html#eitherDecodeSpecial"><span class="hs-identifier hs-var hs-var">eitherDecodeSpecial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String a
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String a)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Either String a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString)
-&gt; (ByteString -&gt; Text) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeLatin1</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Encode Special Characters.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- Where:</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- Data.Aeson.Text.encodeToLazyText :: ToJSON a =&gt; a -&gt; Text</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- Data.Text.Lazy.Encoding.encodeUtf8 :: Text -&gt; ByteString</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span id="local-6989586621679095699"><span class="annot"><a href="MyJson.html#encodeSpecial"><span class="hs-identifier hs-type">encodeSpecial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679095699"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095699"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-95"></span><span id="encodeSpecial"><span class="annot"><span class="annottext">encodeSpecial :: forall a. ToJSON a =&gt; a -&gt; ByteString
</span><a href="MyJson.html#encodeSpecial"><span class="hs-identifier hs-var hs-var">encodeSpecial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (a -&gt; Text) -&gt; a -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToJSON a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">encodeToLazyText</span></span><span>
</span><span id="line-96"></span></pre></body></html>