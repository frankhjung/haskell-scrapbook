<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{-|

Module      : RepMax
Description : Repeat maximum element for entire list
Copyright   : &#169; Frank Jung, 2020
License     : GPL-3

From
&lt;https://danilafe.com/blog/haskell_lazy_evaluation/ Time Traveling In Haskell: How It Works And How To Use It&gt; by Daniel Lafe.

Code for what Csongor calls the repMax problem:

&gt; Imagine you had a list, and you wanted to replace all the elements of
&gt; the list with the largest element, by only passing the list once.

How can we possibly do this in one pass? First, we need to find the maximum
element, and only then can we have something to replace the other numbers
with! It turns out, though, that we can just expect to have the future
value, and all will be well.

In the function 'repMax' takes the list of integers, each of which it must
replace with their maximum element. It also takes as an argument the
maximum element, as if it had already been computed. It does, however,
still compute the intermediate maximum element, in the form of @m'@.
Otherwise, where would the future value even come from?

Thus far, nothing too magical has happened. It&#8217;s a little strange to expect
the result of the computation to be given to us; it just looks like wishful
thinking. The real magic happens in Csongor&#8217;s 'doRepMax' function.

Look, in particular, on the line with the @where@ clause. We see that
'repMax' returns the maximum element of the list, largest, and the
resulting list @xs'@ consisting only of /largest/ repeated as many times as
@xs@ had elements. But what&#8217;s curious is the call to 'repMax' itself. It
takes as input @xs@, the list we&#8217;re supposed to process and largest, the
value that /it itself returns/.

See also &lt;https://kcsongor.github.io/time-travel-in-haskell-for-dummies/ Time travel in Haskell for dummies&gt;
by Csongor Kiss.

See
&lt;https://stackoverflow.com/questions/44558242/picture-how-mapaccumr-works this&gt;
for an explanation on how 'mapAccumR' works.

== Example

Run 'doRepMax' or 'foldMax' over some lists:

&gt;&gt;&gt; doRepMax [2,3,1,4,5]
[5,5,5,5,5]

&gt;&gt;&gt; doRepMax [-2,-3,-1,-4,-5]
[-1,-1,-1,-1,-1]

-}</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">RepMax</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="RepMax.html#doRepMax"><span class="hs-identifier">doRepMax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="RepMax.html#foldMax"><span class="hs-identifier">foldMax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="RepMax.html#repMax"><span class="hs-identifier">repMax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="RepMax.html#traverseMax"><span class="hs-identifier">traverseMax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="RepMax.html#traverseMax%27"><span class="hs-identifier">traverseMax'</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">First</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getFirst</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapAccumR</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">-- | Replace list with maximum value in the list.</span></span><span>
</span><span id="line-65"></span><span id="local-6989586621679096613"><span class="annot"><a href="RepMax.html#doRepMax"><span class="hs-identifier hs-type">doRepMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679096613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>      </span><span class="annot"><span class="hs-comment">-- ^ input list</span></span><span>
</span><span id="line-67"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ list with elements replaced with maximum value</span></span><span>
</span><span id="line-68"></span><span id="doRepMax"><span class="annot"><span class="annottext">doRepMax :: forall a. Integral a =&gt; [a] -&gt; [a]
</span><a href="RepMax.html#doRepMax"><span class="hs-identifier hs-var hs-var">doRepMax</span></a></span></span><span> </span><span id="local-6989586621679096673"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096673"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096674"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096681"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096681"><span class="hs-identifier hs-var">largest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096674"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096674"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; (a, [a])
forall a. Integral a =&gt; [a] -&gt; a -&gt; (a, [a])
</span><a href="RepMax.html#repMax"><span class="hs-identifier hs-var">repMax</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096673"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096681"><span class="hs-identifier hs-var">largest</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">-- | Repeat given maximum for entire list.</span></span><span>
</span><span id="line-73"></span><span id="local-6989586621679096618"><span class="annot"><a href="RepMax.html#repMax"><span class="hs-identifier hs-type">repMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679096618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>        </span><span class="annot"><span class="hs-comment">-- ^ list to replace</span></span><span>
</span><span id="line-75"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096618"><span class="hs-identifier hs-type">a</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ maximum value used in replacement</span></span><span>
</span><span id="line-76"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679096618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ maximum and modified list maximum element</span></span><span>
</span><span id="line-77"></span><span id="repMax"><span class="annot"><span class="annottext">repMax :: forall a. Integral a =&gt; [a] -&gt; a -&gt; (a, [a])
</span><a href="RepMax.html#repMax"><span class="hs-identifier hs-var hs-var">repMax</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679096688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096688"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096688"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="annot"><a href="RepMax.html#repMax"><span class="hs-identifier hs-var">repMax</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679096689"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096689"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679096690"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096690"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096689"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096690"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="annot"><a href="RepMax.html#repMax"><span class="hs-identifier hs-var">repMax</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679096691"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096691"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679096692"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679096693"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">rep</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096695"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096702"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096702"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096695"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096695"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; (a, [a])
forall a. Integral a =&gt; [a] -&gt; a -&gt; (a, [a])
</span><a href="RepMax.html#repMax"><span class="hs-identifier hs-var">repMax</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679096694"><span class="annot"><span class="annottext">m' :: a
</span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096702"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096691"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | Fold version of 'repMax'.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- Modified to also work with negative values.</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- /&quot;Everything's a fold&quot;./</span><span>
</span><span id="line-88"></span><span id="local-6989586621679096706"><span class="annot"><a href="RepMax.html#foldMax"><span class="hs-identifier hs-type">foldMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679096706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>        </span><span class="annot"><span class="hs-comment">-- ^ list to change</span></span><span>
</span><span id="line-90"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ list replaced with maximum element</span></span><span>
</span><span id="line-91"></span><span id="foldMax"><span class="annot"><span class="annottext">foldMax :: forall a. Integral a =&gt; [a] -&gt; [a]
</span><a href="RepMax.html#foldMax"><span class="hs-identifier hs-var hs-var">foldMax</span></a></span></span><span> </span><span id="local-6989586621679096712"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096712"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096713"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621679096719"><span class="annot"><span class="annottext">m :: a
</span><a href="#local-6989586621679096719"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096712"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096712"><span class="hs-identifier hs-var">xs</span></a></span><span>              </span><span class="hs-comment">-- initial max value</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096713"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096713"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096725"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096725"><span class="hs-identifier hs-var">largest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([a], a) -&gt; a -&gt; ([a], a)) -&gt; ([a], a) -&gt; [a] -&gt; ([a], a)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679096727"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096727"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096728"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096728"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679096729"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096729"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096725"><span class="hs-identifier hs-var">largest</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096727"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096729"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096728"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096719"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096712"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Generalise 'repMax' where input is a @Traversable@.</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- Seed value from @First@ of @Foldable@.</span><span>
</span><span id="line-99"></span><span id="local-6989586621679096628"><span id="local-6989586621679096629"><span class="annot"><a href="RepMax.html#traverseMax"><span class="hs-identifier hs-type">traverseMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679096628"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679096629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096628"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096629"><span class="hs-identifier hs-type">a</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ traversable input</span></span><span>
</span><span id="line-101"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096628"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096629"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ modified with maximum element</span></span><span>
</span><span id="line-102"></span><span id="traverseMax"><span class="annot"><span class="annottext">traverseMax :: forall (t :: * -&gt; *) a. (Traversable t, Integral a) =&gt; t a -&gt; t a
</span><a href="RepMax.html#traverseMax"><span class="hs-identifier hs-var hs-var">traverseMax</span></a></span></span><span> </span><span id="local-6989586621679096739"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096740"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679096746"><span class="annot"><span class="annottext">m :: a
</span><a href="#local-6989586621679096746"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; a
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; Maybe a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">First a -&gt; Maybe a
forall a. First a -&gt; Maybe a
</span><span class="hs-identifier hs-var">getFirst</span></span><span> </span><span class="annot"><span class="annottext">(First a -&gt; Maybe a) -&gt; First a -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; First a) -&gt; t a -&gt; First a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; First a
forall a. Maybe a -&gt; First a
</span><span class="hs-identifier hs-var">First</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; First a) -&gt; (a -&gt; Maybe a) -&gt; a -&gt; First a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096755"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">largest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096740"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096740"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; (a, a)) -&gt; a -&gt; t a -&gt; (a, t a)
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><span class="hs-identifier hs-var">mapAccumR</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096756"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096756"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679096757"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096756"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">largest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096746"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | Generalise 'repMax' where input is a @Traversable@.</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- Seed maximum value from head of list or 0 if empty.</span><span>
</span><span id="line-110"></span><span id="local-6989586621679096758"><span id="local-6989586621679096759"><span class="annot"><a href="RepMax.html#traverseMax%27"><span class="hs-identifier hs-type">traverseMax'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679096758"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679096759"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096758"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096759"><span class="hs-identifier hs-type">a</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ traversable input</span></span><span>
</span><span id="line-112"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096758"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096759"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ modified with maximum element</span></span><span>
</span><span id="line-113"></span><span id="traverseMax%27"><span class="annot"><span class="annottext">traverseMax' :: forall (t :: * -&gt; *) a. (Traversable t, Integral a) =&gt; t a -&gt; t a
</span><a href="RepMax.html#traverseMax%27"><span class="hs-identifier hs-var hs-var">traverseMax'</span></a></span></span><span> </span><span id="local-6989586621679096768"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096768"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096769"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679096780"><span class="annot"><span class="annottext">m :: a
</span><a href="#local-6989586621679096780"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t a -&gt; Bool
forall a. t a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096769"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; (t a -&gt; [a]) -&gt; t a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; [a]
forall a. t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096768"><span class="hs-identifier hs-var">t</span></a></span><span>   </span><span class="hs-comment">-- initial max value</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096781"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096781"><span class="hs-identifier hs-var">largest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096769"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096769"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; (a, a)) -&gt; a -&gt; t a -&gt; (a, t a)
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><span class="hs-identifier hs-var">mapAccumR</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096782"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096782"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679096783"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096783"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096782"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096783"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096781"><span class="hs-identifier hs-var">largest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679096768"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-117"></span></pre></body></html>