<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|

Module      : ZipFold
Description : Zipping with folds
Copyright   : &#169; Frank Jung, 2020
License     : GPL-3

From
&lt;https://doisinkidney.com/posts/2020-08-22-some-more-list-algorithms.html Zipping with Folds&gt;
which is based on
&lt;http://okmij.org/ftp/Streams.html#zip-folds How to Zip with Folds&gt;.

The 'Prelude's version of 'zip' uses recursion:

@
zip :: [a] -&gt; [b] -&gt; [(a,b)]
zip []     _bs    = []
zip _as    []     = []
zip (a:as) (b:bs) = (a,b) : zip as bs
@

But, this won't work for streams. The version included below /does/ work with
streams. It uses a recursive type to represent the stream data. This
matches from the beginning of the stream. You could match from the end of
the stream by swapping 'foldr' with 'foldl'.

-}</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ZipFold</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZipFold.html#Zip"><span class="hs-identifier">Zip</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZipFold.html#zip"><span class="hs-identifier">zip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZipFold.html#zip%27"><span class="hs-identifier">zip'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">zip</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Defines a recursive type.</span><span>
</span><span id="line-34"></span><span class="hs-keyword">newtype</span><span> </span><span id="Zip"><span class="annot"><a href="ZipFold.html#Zip"><span class="hs-identifier hs-var">Zip</span></a></span></span><span> </span><span id="local-6989586621679096044"><span class="annot"><a href="#local-6989586621679096044"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679096043"><span class="annot"><a href="#local-6989586621679096043"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Zip"><span class="annot"><a href="ZipFold.html#Zip"><span class="hs-identifier hs-var">Zip</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runZip"><span class="annot"><span class="annottext">forall a b. Zip a b -&gt; a -&gt; (Zip a b -&gt; b) -&gt; b
</span><a href="ZipFold.html#runZip"><span class="hs-identifier hs-var hs-var">runZip</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679096044"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZipFold.html#Zip"><span class="hs-identifier hs-type">Zip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096044"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096043"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096043"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096043"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | Function to fuse two folds.</span><span>
</span><span id="line-37"></span><span id="local-6989586621679096038"><span id="local-6989586621679096039"><span class="annot"><a href="ZipFold.html#zip"><span class="hs-identifier hs-type">zip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096039"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679096038"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679096039"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679096038"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-38"></span><span id="zip"><span class="annot"><span class="annottext">zip :: forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="ZipFold.html#zip"><span class="hs-identifier hs-var hs-var">zip</span></a></span></span><span> </span><span id="local-6989586621679096007"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096007"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679096006"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679096006"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Zip a [(a, b)] -&gt; [(a, b)]) -&gt; Zip a [(a, b)] -&gt; [(a, b)])
-&gt; (Zip a [(a, b)] -&gt; [(a, b)])
-&gt; [a]
-&gt; Zip a [(a, b)]
-&gt; [(a, b)]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Zip a [(a, b)] -&gt; [(a, b)]) -&gt; Zip a [(a, b)] -&gt; [(a, b)]
forall {a} {b}. a -&gt; (Zip a b -&gt; b) -&gt; Zip a b -&gt; b
</span><a href="#local-6989586621679096004"><span class="hs-identifier hs-var">xf</span></a></span><span> </span><span class="annot"><span class="annottext">Zip a [(a, b)] -&gt; [(a, b)]
forall {p} {a}. p -&gt; [a]
</span><a href="#local-6989586621679096003"><span class="hs-identifier hs-var">xb</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096007"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; (Zip a [(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)]) -&gt; Zip a [(a, b)]
forall a b. (a -&gt; (Zip a b -&gt; b) -&gt; b) -&gt; Zip a b
</span><a href="ZipFold.html#Zip"><span class="hs-identifier hs-var">Zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b
 -&gt; (a -&gt; (Zip a [(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)])
 -&gt; a
 -&gt; (Zip a [(a, b)] -&gt; [(a, b)])
 -&gt; [(a, b)])
-&gt; (a -&gt; (Zip a [(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)])
-&gt; [b]
-&gt; a
-&gt; (Zip a [(a, b)] -&gt; [(a, b)])
-&gt; [(a, b)]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">b
-&gt; (a -&gt; (Zip a [(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)])
-&gt; a
-&gt; (Zip a [(a, b)] -&gt; [(a, b)])
-&gt; [(a, b)]
forall {b} {a} {b} {a}.
b
-&gt; (a -&gt; (Zip a b -&gt; b) -&gt; b)
-&gt; a
-&gt; (Zip a b -&gt; [(a, b)])
-&gt; [(a, b)]
</span><a href="#local-6989586621679096002"><span class="hs-identifier hs-var">yf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Zip a [(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)]
forall {p} {p} {a}. p -&gt; p -&gt; [a]
</span><a href="#local-6989586621679096001"><span class="hs-identifier hs-var">yb</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679096006"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621679096004"><span class="annot"><span class="annottext">xf :: a -&gt; (Zip a b -&gt; b) -&gt; Zip a b -&gt; b
</span><a href="#local-6989586621679096004"><span class="hs-identifier hs-var hs-var">xf</span></a></span></span><span> </span><span id="local-6989586621679096000"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096000"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679095999"><span class="annot"><span class="annottext">Zip a b -&gt; b
</span><a href="#local-6989586621679095999"><span class="hs-identifier hs-var">xk</span></a></span></span><span> </span><span id="local-6989586621679095998"><span class="annot"><span class="annottext">Zip a b
</span><a href="#local-6989586621679095998"><span class="hs-identifier hs-var">yk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zip a b -&gt; a -&gt; (Zip a b -&gt; b) -&gt; b
forall a b. Zip a b -&gt; a -&gt; (Zip a b -&gt; b) -&gt; b
</span><a href="ZipFold.html#runZip"><span class="hs-identifier hs-var hs-var">runZip</span></a></span><span> </span><span class="annot"><span class="annottext">Zip a b
</span><a href="#local-6989586621679095998"><span class="hs-identifier hs-var">yk</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096000"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Zip a b -&gt; b
</span><a href="#local-6989586621679095999"><span class="hs-identifier hs-var">xk</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679096003"><span class="annot"><span class="annottext">xb :: p -&gt; [a]
</span><a href="#local-6989586621679096003"><span class="hs-identifier hs-var hs-var">xb</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679096002"><span class="annot"><span class="annottext">yf :: b
-&gt; (a -&gt; (Zip a b -&gt; b) -&gt; b)
-&gt; a
-&gt; (Zip a b -&gt; [(a, b)])
-&gt; [(a, b)]
</span><a href="#local-6989586621679096002"><span class="hs-identifier hs-var hs-var">yf</span></a></span></span><span> </span><span id="local-6989586621679095997"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679095997"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679095996"><span class="annot"><span class="annottext">a -&gt; (Zip a b -&gt; b) -&gt; b
</span><a href="#local-6989586621679095996"><span class="hs-identifier hs-var">yk</span></a></span></span><span> </span><span id="local-6989586621679095995"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095995"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679095994"><span class="annot"><span class="annottext">Zip a b -&gt; [(a, b)]
</span><a href="#local-6989586621679095994"><span class="hs-identifier hs-var">xk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095995"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679095997"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Zip a b -&gt; [(a, b)]
</span><a href="#local-6989586621679095994"><span class="hs-identifier hs-var">xk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; (Zip a b -&gt; b) -&gt; b) -&gt; Zip a b
forall a b. (a -&gt; (Zip a b -&gt; b) -&gt; b) -&gt; Zip a b
</span><a href="ZipFold.html#Zip"><span class="hs-identifier hs-var">Zip</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Zip a b -&gt; b) -&gt; b
</span><a href="#local-6989586621679095996"><span class="hs-identifier hs-var">yk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679096001"><span class="annot"><span class="annottext">yb :: p -&gt; p -&gt; [a]
</span><a href="#local-6989586621679096001"><span class="hs-identifier hs-var hs-var">yb</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | Zip from fold.</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- &gt;&gt;&gt; zip' [1,2,3] [4,5,6]</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- [(1,4),(2,5),(3,6)]</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- &gt;&gt;&gt; zip' &quot;abc&quot; []</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- &gt;&gt;&gt; zip' [] &quot;abc&quot;</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-57"></span><span id="local-6989586621679095992"><span id="local-6989586621679095993"><span class="annot"><a href="ZipFold.html#zip%27"><span class="hs-identifier hs-type">zip'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679095993"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679095992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679095993"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679095992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-58"></span><span id="zip%27"><span class="annot"><span class="annottext">zip' :: forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="ZipFold.html#zip%27"><span class="hs-identifier hs-var hs-var">zip'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; ([b] -&gt; [(a, b)]) -&gt; [b] -&gt; [(a, b)])
-&gt; ([b] -&gt; [(a, b)]) -&gt; [a] -&gt; [b] -&gt; [(a, b)]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ([b] -&gt; [(a, b)]) -&gt; [b] -&gt; [(a, b)]
forall {a} {b}. a -&gt; ([b] -&gt; [(a, b)]) -&gt; [b] -&gt; [(a, b)]
</span><a href="#local-6989586621679095990"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, b)] -&gt; [b] -&gt; [(a, b)]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679095990"><span class="annot"><span class="annottext">go :: a -&gt; ([b] -&gt; [(a, b)]) -&gt; [b] -&gt; [(a, b)]
</span><a href="#local-6989586621679095990"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [(a, b)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="#local-6989586621679095990"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679095988"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095988"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679095987"><span class="annot"><span class="annottext">[b] -&gt; [(a, b)]
</span><a href="#local-6989586621679095987"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095986"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679095986"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679095985"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679095985"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095988"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679095986"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [(a, b)]
</span><a href="#local-6989586621679095987"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679095985"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-62"></span></pre></body></html>